<p>
  <%= form.label :notation_id, "Notation:", :class => "text" %><br />
  <%= form.select :notation_id, notation_options %><br />
</p>

<p>
  <%= form.label :name, "Notation-specific name:", :class => "text" %><br />
  <%= form.text_field :name, :class => "text2" %><br />
  <small>Optional: only specify if this notation gives these instructions a specific name.</small>
</p>

<p>
  <%= form.label :description, "Description:", :class => "text" %><br />
  <%= form.text_area :description, :class => "description" %><br />
  <small>Use <a href="http://daringfireball.net/projects/markdown/syntax">Markdown</a> for formatting</small>
</p>

<p>
  <%= form.label :definition, "Instructions:", :class => "text" %><br />
  <%= form.text_area :definition, :class => "instructions" %>
</p>

<% if form.object.figure && form.object.figure.figure_sources.any? %>
<p class="text">Which sources reference these specific instructions?</p>
<ul class="references">
  <%= form.fields_for :referenced_sources do |refs| %>
    <% form.object.figure.figure_sources.each do |source| %>
      <li>
        <%= reference_check_box(refs, form.object, source) %>
        <%= Bibliographer.format(source.kind, source.data).html_safe %>
      </li>
    <% end %>
  <% end %>
</ul>
<% end %>

<p>Illustrations:</p>

<div id="thumbnails" data-next-number="<%= form.object.illustrations.next_number %>" data-prefix="<%= form.object_name %>">
  <%= render :partial => "illustrations/thumbnail", :locals => { :form => form, :name => "old_illustrations" }, :collection => form.object.illustrations %>
</div>

<p id="add_illustration">
  <%= fields_for :illustration do |i| %>
    <%= i.label :file, "Add an illustration:", :class => "text" %>
    <span><%= i.file_field :file, "data-behaviors" => "add-illustration", "data-url" => illustrations_path %></span>
  <% end %>
</p>

<iframe id="invisible" style="display: none"></iframe>
