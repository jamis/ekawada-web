<% @title = "Edit this construction" %>

<% form_for(@construction, :html => { :multipart => true }) do |f| %>
  <fieldset>
    <legend>Instructions</legend>

    Notation: <%= @construction.notation %><br />
    <%= f.text_area :definition, :class => "instructions" %>
  </fieldset>

  <% @construction.illustrations.each do |illustration| %>
    <% f.fields_for("illustrations[]", illustration) do |i| %>
      <fieldset>
        <legend>Illustration</legend>
        <strong><%= illustration.image.original_filename %></strong><br />
        <%= i.hidden_field :id %>
        <%= i.hidden_field :position %>
        <%= i.hidden_field :delete, :value => "0" %>
        Name this illustration: <%= i.text_field :name %> (e.g., "Fig. 1")<br />
        Caption (optional):<br />
        <%= i.text_area :caption, :class => "caption" %>
      </fieldset>
    <% end %>
  <% end %>

  <fieldset>
    <legend>Illustration</legend>

    <% f.fields_for("illustrations[]", Illustration.new(:position => @construction.illustrations.length)) do |i| %>
      <%= i.file_field :image %><br />
      Name this illustration: <%= i.text_field :name %> (e.g., "Fig. 1")<br />
      Caption (optional):<br />
      <%= i.text_area :caption, :class => "caption" %>
      <%= i.hidden_field :position %>
    <% end %>
  </fieldset>

  <%= f.submit "Save changes" %>
<% end %>
